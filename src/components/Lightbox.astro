<dialog id="lightbox">
  <form method="dialog">
    <button aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
    </button>
  </form>
  <div class="lightbox-content">
    <img id="lightbox-img" src="" alt="" />
  </div>
</dialog>

<script>
  const dialog = document.querySelector('#lightbox') as HTMLDialogElement;
  const lightboxImg = document.querySelector('#lightbox-img') as HTMLImageElement;

  // Find all images within case study content
  const images = document.querySelectorAll('.case-study-content img');

  images.forEach(img => {
    // Make them look clickable
    (img as HTMLElement).style.cursor = 'zoom-in';
    
    img.addEventListener('click', () => {
      const src = img.getAttribute('src');
      const alt = img.getAttribute('alt');
      
      if (src && dialog && lightboxImg) {
        lightboxImg.src = src;
        lightboxImg.alt = alt || '';
        dialog.showModal();
      }
    });
  });

  // Close when clicking the backdrop
  dialog?.addEventListener('click', (e) => {
    if (e.target === dialog) {
      dialog.close();
    }
  });
</script>

<style>
  dialog {
    border: none;
    padding: 0;
    background: transparent;
    max-width: 90vw;
    max-height: 90vh;
    overflow: hidden;
    outline: none;
  }

  dialog::backdrop {
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(4px);
  }

  .lightbox-content {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 100%;
  }

  #lightbox-img {
    max-width: 100%;
    max-height: 90vh;
    object-fit: contain;
    border-radius: 4px;
    box-shadow: 0 20px 50px rgba(0,0,0,0.3);
  }

  button {
    position: fixed;
    top: 1rem;
    right: 1rem;
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    padding: 0.5rem;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s;
    z-index: 10;
  }

  button:hover {
    background: rgba(255, 255, 255, 0.4);
  }

  /* Prevent body scroll when open */
  dialog[open] {
    display: flex;
    align-items: center;
    justify-content: center;
  }
</style>
